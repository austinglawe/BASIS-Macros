Your Cause
___________________________________________________________________________________________________________________________________________
Fundraising Side
-------------------------------------------------------------------------------------------------------------------------------------------
Goal Steps:
Step 1: Download each individual Report from YourCause for each school.
Step 2: Put each file into a single folder.
Step 3: Run the macro to pull files together and create Salesforce Import File.
Step 4: The Macro will produce new folders that will have renamed each report. Once it is completed, upload those files to SharePoint.
Step 5: Review the Salesforce upload file and make any necessary adjustments.
Step 6: Then upload the Salesforce upload file into Salesforce.
___________________________________________________________________________________________________________________________________________
AR Side
-------------------------------------------------------------------------------------------------------------------------------------------
Goal Steps:
Step 1: Download the YourCause Reports from SharePoint. (Ready for AR Team to Process)
Step 2: Put them all into a single folder.
Step 3: Download the Salesforce Report.
Step 4: Run the first macro, inserting the Salesforce Report.
Step 5: Run the second part of the macro to create an import file for Intacct.
Step 6: Review the information in the import file.
Step 7: Upload file into Intacct.
___________________________________________________________________________________________________________________________________________
___________________________________________________________________________________________________________________________________________
___________________________________________________________________________________________________________________________________________
___________________________________________________________________________________________________________________________________________
___________________________________________________________________________________________________________________________________________
___________________________________________________________________________________________________________________________________________
___________________________________________________________________________________________________________________________________________
___________________________________________________________________________________________________________________________________________
___________________________________________________________________________________________________________________________________________
___________________________________________________________________________________________________________________________________________

Execution:
___________________________________________________________________________________________________________________________________________
Fundraising Team
-------------------------------------------------------------------------------------------------------------------------------------------
___________________________________________________________________________________________________________________________________________
___________________________________________________________________________________________________________________________________________
___________________________________________________________________________________________________________________________________________
___________________________________________________________________________________________________________________________________________
___________________________________________________________________________________________________________________________________________

AR Team
-------------------------------------------------------------------------------------------------------------------------------------------
'Step 1: Download the YourCause Reports from SharePoint
'Step 2: Put all the Reports into a single folder.
'Step 3: Download the Salesforce Report ()
'Step 4: Open the Excel Converter Macro File ()
'Step 5:Run the First Macro (Subroutine)
'(The macro's step by step process is below)
'------------------------------------------------------------------------------------------------------------------------------------------
'------------------------------------------------------------------------------------------------------------------------------------------
'------------------------------------------------------------------------------------------------------------------------------------------
'------------------------------------------------------------------------------------------------------------------------------------------

Public Sub YourCause_AR_Team_Step1()
    ' Last Updated 03.19.2024
    
    ' Step 1: Dim the variables that will be used.
        Dim DonationSiteName As String
        Dim SFReportName As String
        Dim DateTime As String
        Dim wsSFReport As Worksheet
    
    ' Step 2: Set the value of the DonationSiteName and SFReportName (based on the report to be used).
        DonationSiteName = "YourCause"
        SFReportName = "1.1d_Propay"
    
    ' Step 3: Prompt the user for confirmation of Reset and to start the macro
        UserResponse = MsgBox("Are you sure you want to start the " & DonationSiteName & " Macro? Doing so, will reset all worksheets in this file.", _
          vbYesNo + vbExclamation + vbDefaultButton2, "Confirm Reset")
    
    ' Step 4: Check User's Response (if user clicks No, then end the macro, otherwise proceed to next steps)
        If UserResponse = vbNo Then
          Exit Sub
        End if
    
    ' Step 5: Assign a value to the DateTime Variable (ZYXWVUT Year.Month.Day - Hour.Minute.Second) - This will allow it to be a new unique variable any given second.
        DateTime = "ZYXWVUT" & Format(Now()," YYYY.MM.DD - HH.MM.SS")
    
    ' Step 6: Create a new Worksheet using the "DateTime" variable name.
        ThisWorkbook.Sheets.Add(After:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count)).Name = DateTime
    
    ' Step 7: Delete all exisiting worksheets except for the 'DateTime' worksheet that was just created.
        Application.DisplayAlerts = False
          For Each ws In ThisWorkbook.Worksheets
            If ws.Name <> DateTime Then
              ws.Delete
            End If
          Next ws
        Application.DisplayAlerts = True
    
    ' Step 8: Rename the 'DateTime' Worksheet to "Salesforce Report"
        ThisWorkbook.Sheets(DateTime).Name = "Salesforce Report"
    
    ' Step 9: Set the variable 'wsSFReport' to the worksheet that was just renamed to "Salesforce Report".
        Set wsSFReport = ThisWorkbook.Sheets("Salesforce Report")
    
    
    ' Steps 10-14: Format the "Salesforce Report" worksheet to be ready for user to input the Salesforce Report and proceed to the second step of the macro.
        
        ' Step 10: Unprotect all the cells in the "Salesforce Report" Worksheet excel for column A.
          wsSFReport.Columns("B:XFD").Locked = False
          wsSFReport.Columns("A:A").Locked = True
      
        ' Start setting up the environment to make it easy for the user to know what steps to take next

            ' Step 11: Change the Column Width of Column A.
                wsSFReport.Range("A:A").ColumnWidth = 42
            
            ' Step 12: Create a message pointing the user where to put the Salesforce Report
                With wsSFReport.Range("A1")
                    .Value = ",------------------------------------------------------->"
                    .Interior.Color = vbRed
                    .Font.ColorIndex = 6
                End With
    
                With wsSFReport.Range("A2:A4")
                    .Merge
                    .WrapText = True
                    .HorizontalAlignment = xlLeft
                    .VerticalAlignment = xlTop
                    .Value = "''---Please place the Salesforce information from the """ & SFReportName & """ Report, in Cell B1"
                    .Interior.Color = RGB(255, 0, 0)
                    .Font.Color = vbYellow
                End With
    
            ' Step 13: Add a button for the user to easily click when they are ready for the next step.

                ' 13a: Set the Button Shape (Button Shape, Start Position (Left to right), Start Position (Top to Bottom), Button Length, Button Height)
                    Set ButtonShape = wsSFReport.Shapes.AddShape(msoShapeRectangle, 0, 59, 209, 301)
    
                ' 13b: Format the Text on the Button
                    ButtonText = "CLICK HERE to go to the second step of the " & DonationSiteName & " Converter."               ' Value of the text within the button
                    With ButtonShape
                        .OnAction = DonationSiteName & "_AR_Team_Step2"                                                         ' Embedding the Specific Converter Macro to the button
                        .TextFrame.Characters.Text = ButtonText
                        .TextFrame.Characters.Font.Name = "Calibri"                                                             ' Button Font Style
                        .TextFrame.Characters.Font.FontStyle = "Bold"                                                           ' Make Button Font Bold
                        .TextFrame.Characters.Font.Size = 35                                                                    ' Button Font Size
                        .TextFrame.Characters.Font.Color = RGB(0, 0, 0)                                                         ' Black Font Color
                        .TextFrame.HorizontalAlignment = xlCenter                                                               ' Center the font within the button (left to right)
                        .TextFrame.VerticalAlignment = xlCenter                                                                 ' Center the font within the button (up and down)
                    End With
    
        ' Step 14: Protect the "Salesforce Report" Worksheet.
            wsSFReport.Protect _
                DrawingObjects:=False, Contents:=True, Scenarios:= False, AllowFormattingCells:=True, _
                AllowFormattingColumns:=True, AllowFormattingRows:=True, AllowInsertingColumns:=True, _
                AllowInsertingRows:=True, AllowInsertingHyperlinks:=True, AllowDeletingColumns:=True, _
                AllowDeletingRows:=True, AllowSorting:=True, AllowFiltering:=True, AllowUsingPivotTables:=True

    ' Step 15: Select B1 of the "Salesforce Report" Worksheet
        wsSFReport.Range("B1").Select

End Sub
'------------------------------------------------------------------------------------------------------------------------------------------
'------------------------------------------------------------------------------------------------------------------------------------------
'------------------------------------------------------------------------------------------------------------------------------------------
'------------------------------------------------------------------------------------------------------------------------------------------
'Step 6: Put the Salesforce Report into the "Salesforce Report" Worksheet.

'Step 7: Run the Second Step of the Macro by Clicking the Macro Button
'(The macro's step by step process is below)
'------------------------------------------------------------------------------------------------------------------------------------------
'------------------------------------------------------------------------------------------------------------------------------------------
'------------------------------------------------------------------------------------------------------------------------------------------
'------------------------------------------------------------------------------------------------------------------------------------------
Public Sub YourCause_AR_Team_Step2()
' Last Updated 03.20.2024

' Step 1: Define and Set the value of DonationSiteName based on the Donation site used in this converter.
    Dim DonationSiteName As String
    Dim HyperlinkColumn As String
    Dim TempFirstRow As Integer
    Dim TempEndRowsToDelete As Integer

    DonationSiteName = "YourCause"
    HyperlinkColumn = "AP"
    TempFirstRow = 2
    TempEndRowsToDelete = 0

' Step 2: Prompt user if they are ready to continue to the second step of the YourCause Converter.
    UserResponse = MsgBox("Are you sure you want to continue to the second step? You will need to select a single folder for the converter to work. Do you have all files in one folder? If not, please select 'No'", _
          vbYesNo + vbExclamation + vbDefaultButton2, "Proceed to Step 2 of the " & DonationSiteName & " Converter")

' Step 3: Check the User's Repsonse (if they select no, end the macro, otherwise continue to the next steps).
    If UserResponse = vbNo Then
        Exit Sub
    End If

' Step 4: Dim the variables that will be used.
    ' The Worksheets
        Dim wsReset As Worksheet
        Dim wsSFReArrange As Worksheet
        Dim wsConsolidated As Worksheet
        Dim wsSummary As Worksheet
        Dim wsSchoolMap As Worksheet
        Dim wsSFReport As Worksheet
        Dim wsImportFile As Worksheet
        Dim wsRelevantSF As Worksheet

    ' Others
        Dim FolderPath As String
        Dim SummaryLastRow As Long
        Dim ConsolidatedLastRow As Long
        Dim LastRowRelevantSF As Long
        Dim LastRowImport As Long

    ' For Loop when pulling files from Folder
        Dim TempLastRow As Integer
        Dim TempSheetName As Integer

    ' Variables For Checking and Finding Column Headings in the Salesforce Report
            Dim SearchRange As Range
            Dim ColumnLetters() As String
            Dim TargetColumnHeaders As Variant
            Dim ColumnHeader As Variant
            Dim i As Integer
            Dim ColumnIndex As Integer
            Dim NewColumnLetter As String

        ' To create a dictionary for the array of column headers that need to be checked
            Dim ColumnDictionary As Object

        ' To use for locating the Salesforce Column Headers later on
            Dim FirstNameColumn As String
            Dim LastNameColumn As String
            Dim PaymentAmountColumn As String
            Dim PaymentIDColumn As String
            Dim CheckNumberColumn As String
            Dim TransactionIDColumn As String
            Dim DisbursementIDColumn As String
            Dim DescriptionColumn As String
            Dim CompanyNameColumn As String
            Dim OpportunityNameColumn As String
            Dim CampaignNameColumn As String
            Dim SchoolNameColumn As String
            Dim TransactionDateColumn As String
            Dim DepositDateColumn As String

        ' Used to Check Column Headers from the Salesforce Report are present.
            Dim EmptyItems As String
            Dim Key As Variant

        ' These are used for naming the Worksheet Names
            Dim SFReport As String
            Dim SFReArrange As String
            Dim SummarySheet As String
            Dim ConsolidatedSheet As String
            Dim ResetSheet As String
            Dim ImportSheet As String
            Dim RelevantSF As String

            SFReport = "'Salesforce Report'!"
            SFReArrange = "'Salesforce Columns Re-Arranged'!"
            SummarySheet = "'Summary Page'!"
            ConsolidatedSheet = "'Consolidated - " & DonationSiteName & "'!"
            RelevantSF = "'Relevant Salesforce'!"
            ImportSheet = "'Import File'!"
            SchoolMap = "'School Mapping'!"
            ResetSheet = "'Total Reset'!"

' Step 5: Set the "Salesforce Report" worksheet to the "wsSFReport" Variable
    Set wsSFReport = ThisWorkbook.Sheets("Salesforce Report")

' Step 6-13: Check the headings of the Worksheet to make sure it has all the required columns (if it doesn't exit the sub, otherwise proceed to the next steps)
    
    ' Step 6: Define the range to search for column headers
        Set SearchRange = wsSFReport.Rows(1)

    ' Step 7: Create an array of column headers to search for, using the "TargetColumnHeaders" Variable
        TargetColumnHeaders = Array("Check/Reference Number", "Check Number", "Close Date", "Company Name", "Deposit Date", "Description", "Disbursement ID", "First Name", "Last Name", _
                                    "Opportunity Name", "Payment: Payment Number", "Payment Amount", "Primary Campaign Source", "School Name")

    ' Step 8: Set the "ColumnDictionary" variable to hold the Column Letter Mappings.
        Set ColumnDictionary = CreateObject("Scripting.Dictionary")

    ' Step 9: Resize the ColumnLetters array to match the size of TargetColumnHeaders
        ReDim ColumnLetters(0 To UBound(TargetColumnHeaders))

    ' Step 10: Search for the required ("Target") Column Headers
        For i = LBound(TargetColumnHeaders) To UBound(TargetColumnHeaders)                              ' LBound is the lowest index position in the array and UBound is the highest (Upper Bound) index position (in this instance, this is the same as: i = 0 To 10) - indexes in VBA (like other coding languages) start at 0 rather than 1.
                On Error Resume Next                                                                    ' 10a. This will turn off the error prompts (in case there are any column headers that are missing).
                Set ColumnHeader = SearchRange.Find(TargetColumnHeaders(i))                             ' 10b. This finds the current ColumnHeader name. If it is not present, then this is left as Nothing.
                If Not ColumnHeader Is Nothing Then                                                     ' 10c0. If the column header is found, proceed
                        ColumnIndex = Range(ColumnHeader.Address).Column                                ' 10c1. Get the column index of the ColumnHeader
                        ColumnIndex = ColumnIndex - 1                                                   ' 10c2. Subtract 1 from the column index
                        NewColumnLetter = Cells(1, ColumnIndex).Address(False, False)                   ' 10c3. Convert the modified column index back to the column letter
                        ColumnLetters(i) = Left(NewColumnLetter, Len(NewColumnLetter) - 1)              ' 10c4. Assign the new column letter to ColumnLetters(i)
                        ColumnDictionary(TargetColumnHeaders(i)) = ColumnLetters(i)                     ' 10c5. Set the Column Letter with its appropriate Column Header
                End If
                On Error GoTo 0                                                                         ' 10d. This will turn error notifications back on.
        Next i

    ' Step 11: Retrieve values from the dictionary to add the column letter to each variable, where they can be found.
        TransactionIDColumn = ColumnDictionary("Check/Reference Number")
        CheckNumberColumn = ColumnDictionary("Check Number")
        TransactionDateColumn = ColumnDictionary("Close Date")
        CompanyNameColumn = ColumnDictionary("Company Name")
        DepositDateColumn = ColumnDictionary("DepositDate")
        DescriptionColumn = ColumnDictionary("Description")
        DisbursementIDColumn = ColumnDictionary("Disbursement ID")
        FirstNameColumn = ColumnDictionary("First Name")
        LastNameColumn = ColumnDictionary("Last Name")
        OpportunityNameColumn = ColumnDictionary("Opportunity Name")
        PaymentIDColumn = ColumnDictionary("Payment: Payment Number")
        PaymentAmountColumn = ColumnDictionary("Payment Amount")
        CampaignNameColumn = ColumnDictionary("Primary Campaign Source")
        SchoolNameColumn = ColumnDictionary("School Name")
        
    ' Step 12: Check for empty dictionary items
        EmptyItems = ""
        For Each Key In ColumnDictionary.Keys
            If ColumnDictionary(Key) = "" Then
                EmptyItems = EmptyItems & Key & vbCrLf
            End If
        Next Key

    ' Step 13: If any column headers are missing: display which ones are missing, clear contents, and then exit the Sub. (If none are missing, proceed to the next steps.)
        If EmptyItems <> "" Then
            wsSFReport.Columns("B:XFD").ClearContents
            wsSFReport.Range("B1").Select
            MsgBox "These required column headers are missing from the Salesforce Report you attempted to use: & vbCrLF" _
                    & vbCrLf & EmptyItems & vbCrLf & "Please find the Correct Report and Try again!", vbExclamation, "Missing Column Headers"
            Exit Sub
        End If

' Steps 14-15: Ask User to choose a Folder Path. If they cancel, end the Sub. If the folder is empty, end the Sub. Otherwise, proceed to the next steps.
    ' Step 14: Ask User for a FolderPath (if the user cancels, end the Sub).
        With Application.FileDialog(msoFileDialogFolderPicker)
            .Title = "Select a folder"
            .AllowMultiSelect = False
            If .Show = -1 Then
                FolderPath = .SelectedItems(1)
            Else
                MsgBox "No folder path was selected. When you are ready, please click the button again. Then select the folder you wish to use."
                Exit Sub
            End If
        End With

    ' Step 15: Check that the folder has at least one file. If it doesn't, exit the Sub. If it does, continue on.
        If Dir(FolderPath & "\*.csv") = "" Then
            MsgBox "The selected folder does not contain any CSV files. Please find the folder you'd like to use and make sure that it contains at least one file. Then try again."
            Exit Sub
        End If

' Step 16-: Start setting up the workbook environment to be able to consolidate the reports into it.
    
    ' Step 16: Unprotect the "Salesforce Report" Worksheet
        wsSFReport.Unprotect

    ' Step 17: Delete Column A of the "Salesforce Report" Worksheet
        wsSFReport.Columns("A:A").Delete

    ' Step : Add the rest of the worksheets that are needed. The variables include the 'WorksheetName'! (the single quotes and exlamation mark in order to use to refer to these sheets later). _
        To add the correct names to the new worksheets though, the first character and the last two need to be taken off of the variables - the LEFT() and RIGHT() functions are used to do this.

            ThisWorkbook.Sheets.Add(Before:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count)).Name = Left(Right(SFReArrange, Len(SFReArrange) - 1), Len(Right(SFReArrange, Len(SFReArrange) - 1)) - 2)                                 ' Worksheet: "Salesforce Columns Re-Arranged"
            ThisWorkbook.Sheets.Add(Before:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count)).Name = Left(Right(SummarySheet, Len(SummarySheet) - 1), Len(Right(SummarySheet, Len(SummarySheet) - 1)) - 2)                             ' Worksheet: "Summary Page"
            ThisWorkbook.Sheets.Add(After:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count)).Name = Left(Right(ConsolidatedSheet, Len(ConsolidatedSheet) - 1), Len(Right(ConsolidatedSheet, Len(ConsolidatedSheet) - 1)) - 2)          ' Worksheet: "Consolidated - YourCause"
            ThisWorkbook.Sheets.Add(After:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count)).Name = Left(Right(RelevantSF, Len(RelevantSF) - 1), Len(Right(RelevantSF, Len(RelevantSF) - 1)) - 2)                                      ' Worksheet: "Relevant Salesforce"
            ThisWorkbook.Sheets.Add(After:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count)).Name = Left(Right(ImportSheet, Len(ImportSheet) - 1), Len(Right(ImportSheet, Len(ImportSheet) - 1)) - 2)                                  ' Worksheet: "Import File"
            SchoolMapping.School_Map                                                                                                                                                                                                 ' Worksheet: "School Mapping"
            ThisWorkbook.Sheets.Add(After:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count)).Name = Left(Right(ResetSheet, Len(ResetSheet) - 1), Len(Right(ResetSheet, Len(ResetSheet) - 1)) - 2)                                      ' Worksheet: "Total Reset"

    ' Step : Set the worksheets to variables.
            Set wsSFReArrange = ThisWorkbook.Sheets(Left(Right(SFReArrange, Len(SFReArrange) - 1), Len(Right(SFReArrange, Len(SFReArrange) - 1)) - 2))                                                    ' Worksheet: "Salesforce Columns Re-Arranged"
            Set wsSummary = ThisWorkbook.Sheets(Left(Right(SummarySheet, Len(SummarySheet) - 1), Len(Right(SummarySheet, Len(SummarySheet) - 1)) - 2))                                                    ' Worksheet: "Summary Page"
            Set wsConsolidated = ThisWorkbook.Sheets(Left(Right(ConsolidatedSheet, Len(ConsolidatedSheet) - 1), Len(Right(ConsolidatedSheet, Len(ConsolidatedSheet) - 1)) - 2))                           ' Worksheet: "Consolidated - YourCause"
            Set wsRelevantSF = ThisWorkbook.Sheets(Left(Right(RelevantSF, Len(RelevantSF) - 1), Len(Right(RelevantSF, Len(RelevantSF) - 1)) - 2))                                                         ' Worksheet: "Relevant Salesforce"
            Set wsImportFile = ThisWorkbook.Sheets(Left(Right(ImportSheet, Len(ImportSheet) - 1), Len(Right(ImportSheet, Len(ImportSheet) - 1)) - 2))                                                     ' Worksheet: "Import File"
            Set wsSchoolMap = ThisWorkbook.Sheets(Left(Right(SchoolMap, Len(SchoolMap) - 1), Len(Right(SchoolMap, Len(SchoolMap) - 1)) - 2))                                                              ' Worksheet: "School Mappping"
            Set wsReset = ThisWorkbook.Sheets(Left(Right(ResetSheet, Len(ResetSheet) - 1), Len(Right(ResetSheet, Len(ResetSheet) - 1)) - 2))                                                              ' Worksheet: "Total Reset"



    ' Step : Populate the Headers of the "Summary Page" Worksheet
        wsSummary.Range("A1").Value = "Original File Name"
        wsSummary.Range("B1").Value = "Descriptive Name"
        wsSummary.Range("C1").Value = "CSV Naming (Worksheet Name)"
        wsSummary.Range("D1").Value = "Completed"
        wsSummary.Range("E1").Value = "Disbursement Date"
        wsSummary.Range("F1").Value = "School Name"
        wsSummary.Range("G1").Value = "Abbreviated School Name"
        wsSummary.Range("H1").Value = "Disbursement ID"
        wsSummary.Range("I1").Value = "Company Match/Employee Giving"
        wsSummary.Range("J1").Value = "Gross Total - Employee Giving"
        wsSummary.Range("K1").Value = "Gross Total - Company Match"
        wsSummary.Range("L1").Value = "Total Gross Donations"
        wsSummary.Range("M1").Value = "Total Fees - Employee Giving"
        wsSummary.Range("N1").Value = "Total Fees - Company Match"
        wsSummary.Range("O1").Value = "Total Donation Fees"
        wsSummary.Range("P1").Value = "Net Total - Employee Giving"
        wsSummary.Range("Q1").Value = "Net Total - Company Match"
        wsSummary.Range("R1").Value = "Total Net Donations"
        wsSummary.Range("S1").Value = "# of Transactions"
        wsSummary.Range("T1").Value = "Temporary Worksheet Name"

    ' Step : Populate the Headers of the "Counsolidated - YourCause" Worksheet
        wsConsolidated.Range("A1").Value = "Donation Date"
        wsConsolidated.Range("B1").Value = "Company Name"
        wsConsolidated.Range("C1").Value = "Transaction Id"
        wsConsolidated.Range("D1").Value = "Transaction Id [Type]"
        wsConsolidated.Range("E1").Value = "Transaction Amount"
        wsConsolidated.Range("F1").Value = "Fee Amount"
        wsConsolidated.Range("G1").Value = "Disbursement Fee Amount"
        wsConsolidated.Range("H1").Value = "Received Amount"
        wsConsolidated.Range("I1").Value = "Is Disbused?"
        wsConsolidated.Range("J1").Value = "Payment ID"
        wsConsolidated.Range("K1").Value = "Is Most Recent Payment"
        wsConsolidated.Range("L1").Value = "Payment Create Date"
        wsConsolidated.Range("M1").Value = "Payment Status Date"
        wsConsolidated.Range("N1").Value = "Payment Status"
        wsConsolidated.Range("O1").Value = "Donor Type"
        wsConsolidated.Range("P1").Value = "Donor ID"
        wsConsolidated.Range("Q1").Value = "Donor First Name"
        wsConsolidated.Range("R1").Value = "Donor Last Name"
        wsConsolidated.Range("S1").Value = "Donor Full Name"
        wsConsolidated.Range("T1").Value = "Donor Email Address"
        wsConsolidated.Range("U1").Value = "Donor Address"
        wsConsolidated.Range("V1").Value = "Donor Address 2"
        wsConsolidated.Range("W1").Value = "Donor City"
        wsConsolidated.Range("X1").Value = "Donor State/Province/Region"
        wsConsolidated.Range("Y1").Value = "Donor Postal Code"
        wsConsolidated.Range("Z1").Value = "Donor Country"
        wsConsolidated.Range("AA1").Value = "Match Donor Id"
        wsConsolidated.Range("AB1").Value = "Match Donor First Name"
        wsConsolidated.Range("AC1").Value = "Match Donor Last Name"
        wsConsolidated.Range("AD1").Value = "Match Donor Email Address"
        wsConsolidated.Range("AE1").Value = "Dedication Type"
        wsConsolidated.Range("AF1").Value = "Dedication"
        wsConsolidated.Range("AG1").Value = "Designation"
        wsConsolidated.Range("AH1").Value = "Registration Id"
        wsConsolidated.Range("AI1").Value = "Designated Charity Name"
        wsConsolidated.Range("AJ1").Value = "Donation Status"
        wsConsolidated.Range("AK1").Value = "Alternate Recognition Name"
        wsConsolidated.Range("AL1").Value = "Segment Name"
        wsConsolidated.Range("AM1").Value = "Local Currency Recipt Amount"
        wsConsolidated.Range("AN1").Value = "Local Currency Type"
        wsConsolidated.Range("AO1").Value = "Fundraising ID"
        wsConsolidated.Range("AP1").Value = "Original File Name"
        wsConsolidated.Range("AQ1").Value = "Descriptive File Name"
        wsConsolidated.Range("AR1").Value = "CSV Naming (Worksheet Name)"
        wsConsolidated.Range("AS1").Value = "PMT-ID"

    ' Step : Populate the Headers of the "Relevant Salesforce" Worksheet
        wsRelevantSF.Range("A1").Value = "

    ' Step : Populate the Headers of the "Import File" Worksheet
        wsImportFile.Range("A1").Value = "


' Steps : Create a loop (going back to the original FolderPath). The loop will open each file one by one, copy the report as a new worksheet in the workbook, placing it at the end _
        of all other workbooks. It will be renamed based off of its loop number. Then the report information will be copied and pasted into the "Consolidated - YourCause" Worksheet. _
        The original file name will be placed in the "Summary Page" Worksheet in column A, as well as in Column AP of the "Consolidated - YourCause" Worksheet. Once that is completed _
        A checkmark will be made in the "Summary Page" in column D. Then the original file will be closed and it will continue onto the next file until it finishes.

    ' Step : Define the Files to be pulled from the FolderPath and set the variable "TempSheetName" to 1
        File = Dir(FolderPath & "\*.*")
        TempSheetName = 1

    ' Start the loop to accomplish the goals above
        Do While File <> ""
            CurrentFile = Left(File, Len(File) - 4)                                                                                                                                                      ' Create a variable to hold the name of the current file (Taking off the extensions CSV).
            LastRowSummary = wsSummary.Cells(wsSummary.Rows.Count, 1).End(xlUp).Row + 1                                                                                                                  ' Find the last row in column A of the "Summary" Worksheet
            ConsolidatedLastRow = wsConsolidated.Cells(Rows.Count, "A").End(xlUp).Row + 1                                                                                                                ' Find the last row in column A of the "Consolidated - YourCause" Worksheet
            wsSummary.Cells(LastRowSummary, 1).Value = CurrentFile                                                                                                                                       ' Add the file name to column A of the "Summary" Worksheet    
            Set wsTemp = Workbooks.Open(FolderPath & "\" & File).Sheets(1)                                                                                                                               ' Open the CSV file and Copy row 2 to the end of the data and Paste it in "Consolidated Report" Worksheet below all it's other data
            TempEndRow = wsTemp.Cells(Rows.Count, "A").End(xlUp).Row                                                                                                                                     ' Cl
            wsTemp.Rows(TempFirstRow & ":" & (TempEndRow - TempEndRowsToDelete)).Copy wsConsolidated.Cells(ConsolidatedLastRow, 1)                                                                       ' Cl
            wsConsolidated.Range(HyperlinkColumn & ConsolidatedLastRow & ":" & HyperlinkColumn & ((ConsolidatedLastRow) + (TempEndRow - TempEndRowsToDelete - TempFirstRow))).Value = CurrentFile        ' Put current_file_name in column AN of the "Consolidated Report" Worksheet
            Set NewSheet = ThisWorkbook.Sheets.Add(, ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count))                                                                                                     ' Copy the data to a new worksheet in the Converter's Workbook
            NewSheet.Name = TempSheetName                                                                                                                                                                ' Use the TempSheetName 
            ActiveSheet.UsedRange.Copy NewSheet.Cells(1, 1)                                                                                                                                              ' Cl
            NewSheet.Hyperlinks.Add Anchor:=NewSheet.Range(HyperlinkColumn & "1"), Address:="", SubAddress:=SummarySheet & "A1", TextToDisplay:="Return to Summary Page"                                 ' Add a hyperlink in the new worksheet to the "Summary Page" Worksheet (to cell A1)
            NewSheet.Cells.EntireColumn.AutoFit                                                                                                                                                          ' Auto-adjust column widths in the new worksheet
            wsTemp.Parent.Close                                                                                                                                                                          ' Close the opened file.
            wsSummary.Cells(LastRowSummary, "D").Value = "x"                                                                                                                                             ' Place an "x" in the "Summary Page" to show that file is completed.
            wsSummary.Cells(LastRowSummary, "T").Value = TempSheetName                                                                                                                                   ' Add the Temporary Sheet Name to the Summary Page with the corresponding File
            TempSheetName = TempSheetName + 1                                                                                                                                                            ' Add 1 to the TempSheetName count (Temporarily Naming the next sheet 1 + the sheet name just name)
            File = Dir                                                                                                                                                                                   ' Go to the next file
        Loop

' Step : Populate the formulas and Fill Down in all worksheets
    ' Redefine the "______EndRow" Variables

        LastRowSFReArrange = wsSFReport.Cells(Rows.Count, PaymentIDColumn).End(xlUp).Row
        LastRowSummary = wsSummary.Cells(Rows.Count, "A").End(xlUp).Row
        LastRowConsolidated = wsConsolidated.Cells(Rows.Count, "A").End(xlUp).Row
        LastRowRelevantSF = wsRelevantSF.Cells(Rows.Count, "A").End(xlUp).Row
        LastRowImport = wsImportFile.Cells(Rows.Count, "A").End(xlUp).Row


    ' Populate the formulas in the "Salesforce Columns Re-Arranged" Worksheet and then fill the formulas down
        wsSFReArrange.Range("A2").Formula = "=" & SFReport & PaymentIDColumn & "2"                                                            ' "Payment: Payment Number"  (PMT-ID)
        wsSFReArrange.Range("B2").Formula = "=" & SFReport & CampaignNameColumn & "2"                                                         ' "Primary Campaign Source"  (Campaign Name)
        wsSFReArrange.Range("C2").Formula = "=" & SFReport & OpportunityNameColumn & "2"                                                      ' "Opportunity Name"         (Opportunity Name)
        wsSFReArrange.Range("D2").Formula = "=" & SFReport & CheckNumberColumn & "2"                                                          ' "Check Number"             (Check Number - if a check)
        wsSFReArrange.Range("E2").Formula = "=" & SFReport & CompanyNameColumn & "2"                                                          ' "Company Name"             (Company Name)
        wsSFReArrange.Range("F2").Formula = "=" & SFReport & TransactionIDColumn & "2"                                                        ' "Check/Reference Number"   (Transaction ID)
        wsSFReArrange.Range("G2").Formula = "=" & SFReport & DisbursementIDColumn & "2"                                                       ' "Disbursement ID"          (Disbursement ID)
        wsSFReArrange.Range("H2").Formula = "=" & SFReport & FirstNameColumn & "2"                                                            ' "First Name"               (First Name
        wsSFReArrange.Range("I2").Formula = "=" & SFReport & LastNameColumn & "2"                                                             ' "Last Name"                (Last Name)
        wsSFReArrange.Range("J2").Formula = "=" & SFReport & PaymentAmountColumn & "2"                                                        ' "Payment Amount"           (Payment Amount)
        wsSFReArrange.Range("K2").Formula = "=" & SFReport & DescriptionColumn & "2"                                                          ' "Description"              (Description)
        wsSFReArrange.Range("A2:K" & LastRowSFReArrange).FillDown                                                                             ' Fill the Formulas down 

    ' Populate the formulas in the "Summary Page" Worksheet
        ' Descriptive Name
            ' 
                wsSummary.Range("B2").Formula = ""
        ' CSV Naming (Worksheet Name)
            ' 
                wsSummary.Range("C2").Formula = ""


        ' Disbursement Date
            ' 
                wsSummary.Range("E2").Formula = "=TEXT(XLOOKUP(A2, " & ConsolidatedSheet & "AP:AP, " & ConsolidatedSheet & "M:M), ""YYYY.MM.DD"")"

        ' School Name
            ' 
                wsSummary.Range("F2").Formula = "=XLOOKUP(A2, " & ConsolidatedSheet & "AP:AP, " & ConsolidatedSheet & "AI:AI)"

        ' Abbreviated School Name
            ' 
                wsSummary.Range("G2").Formula = ""

        ' Disbursement ID
            ' 
                wsSummary.Range("H2").Formula = "=XLOOKUP(A2, " & ConsolidatedSheet & "AP:AP, " & ConsolidatedSheet & "J:J)"

        ' Company Match/Employee Giving
            ' 
                wsSummary.Range("I2").Formula = ""

        ' Gross Total - Employee Giving
            ' 
                wsSummary.Range("J2").Formula = ""

        ' Gross Total - Company Match
            ' 
                wsSummary.Range("K2").Formula = ""

        ' Total Gross Donation
            ' 
                wsSummary.Range("L2").Formula = ""

        ' Total Fees - Employee Giving
            ' 
                wsSummary.Range("M2").Formula = ""

        ' Total Fees - Company Match
            ' 
                wsSummary.Range("N2").Formula = ""

        ' Total Donation Fees
            ' 
                wsSummary.Range("O2").Formula = ""

        ' Net Total - Employee Giving
            ' 
                wsSummary.Range("P2").Formula = ""

        ' Net Total - Company Match
            ' 
                wsSummary.Range("Q2").Formula = ""

        ' Total Net Donations
            ' 
                wsSummary.Range("R2").Formula = ""

        ' # of Transactions
            ' 
                wsSummary.Range("S2").Formula = ""

    ' Populate the formulas in the "Consolidated - YourCause" Worksheet
    ' Populate the formulas in the "Relevant Salesforce" Worksheet
    ' Populate the formulas in the "Import File" Worksheet

' Rename the Temporary Worksheet Names to CSV Naming Convention

' Using the original folder path provided by the user, create 2 new folders within that folder. Called: "Descriptive File Name", and "CSV File Name". _
    Copy the original files and rename them based on the Descriptive Naming Convention and CSV Naming Convention found in the "Summary Page" Worksheet

' Create the "Descriptive File Name" Folder and copy and paste the files with the Descriptive File Naming Convention

' Create the "CSV File Name" Folder and copy and paste the files with the CSV File Naming Convention

' Rename the worksheet names from the Temporary Worksheet Name to the CSV Naming Convention

' Reorder the worksheets in a descending order (Z-A)-(9-0)

' Hide all the worksheets except for "Consolidated Reports", "Summary Page", "Salesforce Import File", ....

' Reorder the non-hidden worksheets in ascending order (0-9)-(A-Z)

' Activate the "Salesforce Import File" Worksheet and go to "A1"

End Sub
'------------------------------------------------------------------------------------------------------------------------------------------
'------------------------------------------------------------------------------------------------------------------------------------------
'------------------------------------------------------------------------------------------------------------------------------------------
'------------------------------------------------------------------------------------------------------------------------------------------
'Step 8: Check that all the information is correct. Make any adjustments that are needed.
'Step 9: Import the File to Intacct.






        .Range("B2").Formula = ""
        .Range("C2").Formula = ""
        .Range("D2").Formula = ""
        .Range("E2").Formula = ""
        .Range("F2").Formula = ""
        .Range("G2").Formula = ""
        .Range("H2").Formula = ""
        .Range("I2").Formula = ""
        .Range("J2").Formula = ""
        .Range("K2").Formula = ""
        .Range("L2").Formula = ""
        .Range("M2").Formula = ""
        .Range("N2").Formula = ""
        .Range("O2").Formula = ""
        .Range("P2").Formula = ""
        .Range("Q2").Formula = ""
        .Range("R2").Formula = ""
        .Range("S2").Formula = ""
